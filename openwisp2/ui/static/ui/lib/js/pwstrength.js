/* pwstrength-bootstrap 2014-01-06 - GPLv3 & MIT License */
!function(a){var b={};try{if(!a&&module&&module.exports)var a=require("jquery")}catch(c){}!function(a,b){"use strict";var c={};b.forbiddenSequences=["0123456789","9876543210","abcdefghijklmnopqrstuvxywz","qwertyuiop","asdfghjkl","zxcvbnm"],c.wordNotEmail=function(a,b,c){return b.match(/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i)?(a.instances.errors.push(a.ui.spanError(a,"email_as_password")),c):void 0},c.wordLength=function(a,b,c){var d=b.length,e=Math.pow(d,a.rules.raisePower);return d<a.common.minChar&&(e+=c,a.instances.errors.push(a.ui.spanError(a,"password_too_short"))),e},c.wordSimilarToUsername=function(b,c,d){var e=a(b.common.usernameField).val();return e&&c.toLowerCase().match(e.toLowerCase())?(b.instances.errors.push(b.ui.spanError(b,"same_as_username")),d):!1},c.wordTwoCharacterClasses=function(a,b,c){return b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)||b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)||b.match(/(.[!,@,#,$,%,\^,&,*,?,_,~])/)&&b.match(/[a-zA-Z0-9_]/)?c:(a.instances.errors.push(a.ui.spanError(a,"two_character_classes")),!1)},c.wordRepetitions=function(a,b,c){return b.match(/(.)\1\1/)?(a.instances.errors.push(a.ui.spanError(a,"repeated_character")),c):!1},c.wordSequences=function(c,d,e){var f,g=!1;return d.length>2&&(a.each(b.forbiddenSequences,function(a,b){for(f=0;f<d.length-3;f+=1)b.indexOf(d.toLowerCase().substring(f,f+3))>-1&&(g=!0)}),g)?(c.instances.errors.push(c.ui.spanError(c,"sequence_found")),e):!1},c.wordLowercase=function(a,b,c){return b.match(/[a-z]/)&&c},c.wordUppercase=function(a,b,c){return b.match(/[A-Z]/)&&c},c.wordOneNumber=function(a,b,c){return b.match(/\d+/)&&c},c.wordThreeNumbers=function(a,b,c){return b.match(/(.*[0-9].*[0-9].*[0-9])/)&&c},c.wordOneSpecialChar=function(a,b,c){return b.match(/.[!,@,#,$,%,\^,&,*,?,_,~]/)&&c},c.wordTwoSpecialChar=function(a,b,c){return b.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&c},c.wordUpperLowerCombo=function(a,b,c){return b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&c},c.wordLetterNumberCombo=function(a,b,c){return b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)&&c},c.wordLetterNumberCharCombo=function(a,b,c){return b.match(/([a-zA-Z0-9].*[!,@,#,$,%,\^,&,*,?,_,~])|([!,@,#,$,%,\^,&,*,?,_,~].*[a-zA-Z0-9])/)&&c},b.validation=c,b.executeRules=function(c,d){var e=0;return a.each(c.rules.activated,function(f,g){if(g){var h,i=c.rules.scores[f],j=b.validation[f];a.isFunction(j)||(j=c.rules.extra[f]),a.isFunction(j)&&(h=j(c,d,i),h&&(e+=h))}}),e}}(a,b);try{module&&module.exports&&(module.exports=b)}catch(c){}var d={};d.common={},d.common.minChar=6,d.common.usernameField="#username",d.common.onLoad=void 0,d.common.onKeyUp=void 0,d.rules={},d.rules.extra={},d.rules.scores={wordNotEmail:-100,wordLength:-50,wordSimilarToUsername:-100,wordSequences:-50,wordTwoCharacterClasses:2,wordRepetitions:-25,wordLowercase:1,wordUppercase:3,wordOneNumber:3,wordThreeNumbers:5,wordOneSpecialChar:3,wordTwoSpecialChar:5,wordUpperLowerCombo:2,wordLetterNumberCombo:2,wordLetterNumberCharCombo:2},d.rules.activated={wordNotEmail:!0,wordLength:!0,wordSimilarToUsername:!0,wordSequences:!0,wordTwoCharacterClasses:!1,wordRepetitions:!1,wordLowercase:!0,wordUppercase:!0,wordOneNumber:!0,wordThreeNumbers:!0,wordOneSpecialChar:!0,wordTwoSpecialChar:!0,wordUpperLowerCombo:!0,wordLetterNumberCombo:!0,wordLetterNumberCharCombo:!0},d.rules.raisePower=1.4,d.ui={},d.ui.bootstrap2=!1,d.ui.showPopover=!1,d.ui.spanError=function(a,b){"use strict";var c=a.ui.errorMessages[b];return'<span style="color: #d52929">'+c+"</span>"},d.ui.errorMessages={password_too_short:"The Password is too short",email_as_password:"Do not use your email as your password",same_as_username:"Your password cannot contain your username",two_character_classes:"Use different character classes",repeated_character:"Too many repetitions",sequence_found:"Your password contains sequences"},d.ui.verdicts=["Weak","Normal","Medium","Strong","Very Strong"],d.ui.showVerdicts=!0,d.ui.showErrors=!1,d.ui.container=void 0,d.ui.viewports={progress:void 0,verdict:void 0,errors:void 0},d.ui.scores=[14,26,38,50];var e={};!function(a,b){"use strict";b.getContainer=function(b,c){var d;return d=a(b.ui.container),d&&1===d.length||(d=c.parent()),d},b.findElement=function(a,b,c){return b?a.find(b).find(c):a.find(c)},b.getUIElements=function(a,c){var d,e;return a.instances.viewports?a.instances.viewports:(e={},d=b.getContainer(a,c),e.$progressbar=b.findElement(d,a.ui.viewports.progress,"div.progress"),a.ui.showPopover||(e.$verdict=b.findElement(d,a.ui.viewports.verdict,"span.password-verdict"),e.$errors=b.findElement(d,a.ui.viewports.errors,"ul.error-list")),a.instances.viewports=e,e)},b.initProgressBar=function(c,d){var e=b.getContainer(c,d),f="<div class='progress'><div class='";c.ui.bootstrap2||(f+="progress-"),f+="bar'></div></div>",c.ui.viewports.progress?e.find(c.ui.viewports.progress).append(f):a(f).insertAfter(d)},b.initHelper=function(c,d,e,f){var g=b.getContainer(c,d);f?g.find(f).append(e):a(e).insertAfter(d)},b.initVerdict=function(a,c){b.initHelper(a,c,"<span class='password-verdict'></span>",a.ui.viewports.verdict)},b.initErrorList=function(a,c){b.initHelper(a,c,"<ul class='error-list'></ul>",a.ui.viewports.errors)},b.initPopover=function(b,c,d){var e="auto top",f="";b.ui.bootstrap2&&(e="top"),b.ui.showVerdicts&&d.length>0&&(f="<h5><span class='password-verdict'>"+d+"</span></h5>"),b.ui.showErrors&&(f+="<div><ul class='error-list'>",a.each(b.instances.errors,function(a,b){f+="<li>"+b+"</li>"}),f+="</ul></div>"),c.popover("destroy"),c.popover({html:!0,placement:e,trigger:"manual",content:f}),c.popover("show")},b.initUI=function(a,c){a.ui.showPopover||(a.ui.showErrors&&b.initErrorList(a,c),a.ui.showVerdicts&&b.initVerdict(a,c)),b.initProgressBar(a,c)},b.possibleProgressBarClasses=["danger","warning","success"],b.updateProgressBar=function(c,d,e,f){var g=b.getUIElements(c,d).$progressbar,h=g.find(".progress-bar"),i="progress-";c.ui.bootstrap2&&(h=g.find(".bar"),i=""),a.each(b.possibleProgressBarClasses,function(a,b){h.removeClass(i+"bar-"+b)}),h.addClass(i+"bar-"+e),h.css("width",f+"%")},b.updateVerdict=function(a,c,d){var e=b.getUIElements(a,c).$verdict;e.text(d)},b.updateErrors=function(c,d){var e=b.getUIElements(c,d).$errors,f="";a.each(c.instances.errors,function(a,b){f+="<li>"+b+"</li>"}),e.html(f)},b.percentage=function(a,b){var c=Math.floor(100*a/b);return c=0>c?0:c,c=c>100?100:c},b.updateUI=function(a,c,d){var e,f,g;f=b.percentage(d,a.ui.scores[3]),0>=d?(e="danger",g=""):d<a.ui.scores[0]?(e="danger",g=a.ui.verdicts[0]):d<a.ui.scores[1]?(e="danger",g=a.ui.verdicts[1]):d<a.ui.scores[2]?(e="warning",g=a.ui.verdicts[2]):d<a.ui.scores[3]?(e="warning",g=a.ui.verdicts[3]):(e="success",g=a.ui.verdicts[4]),b.updateProgressBar(a,c,e,f),a.ui.showPopover?b.initPopover(a,c,g):(a.ui.showVerdicts&&b.updateVerdict(a,c,g),a.ui.showErrors&&b.updateErrors(a,c))}}(a,e);var f={};!function(a,c){"use strict";var f,g;f=function(c){var d,f=a(c.target),g=f.data("pwstrength-bootstrap"),h=f.val();g.instances.errors=[],d=b.executeRules(g,h),e.updateUI(g,f,d),a.isFunction(g.common.onKeyUp)&&g.common.onKeyUp(c)},c.init=function(b){return this.each(function(c,g){var h=a.extend(!0,{},d),i=a.extend(!0,h,b),j=a(g);i.instances={},j.data("pwstrength-bootstrap",i),j.on("keyup",f),e.initUI(i,j),a.isFunction(i.common.onLoad)&&i.common.onLoad()}),this},c.destroy=function(){this.each(function(b,c){var d=a(c),f=d.data("pwstrength-bootstrap"),g=e.getUIElements(f,d);g.$progressbar.remove(),g.$verdict.remove(),g.$errors.remove(),d.removeData("pwstrength-bootstrap")})},c.forceUpdate=function(){this.each(function(a,b){var c={target:b};f(c)})},c.addRule=function(b,c,d,e){this.each(function(f,g){var h=a(g).data("pwstrength-bootstrap");h.rules.activated[b]=e,h.rules.scores[b]=d,h.rules.extra[b]=c})},g=function(b,c,d){this.each(function(e,f){a(f).data("pwstrength-bootstrap").rules[c][b]=d})},c.changeScore=function(a,b){g.call(this,a,"scores",b)},c.ruleActive=function(a,b){g.call(this,a,"activated",b)},a.fn.pwstrength=function(b){var d;return c[b]?d=c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?a.error("Method "+b+" does not exist on jQuery.pwstrength-bootstrap"):d=c.init.apply(this,arguments),d}}(a,f)}(jQuery);
